Traceback (most recent call last):
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type numeric: "[1.9,4.6,4.6,8.4,12.6,16.8,16.8,21.5,25.8,25.8,30,34.3,34.3,38.6,43.3,47.5,47.5,51.8,56.1,56.1,60.8,65,65,69.3,73.6,77.8,77.8,82.5,86.8,86.8,91,95.3,95.3,99.6,104.3,108.5,108.5,112.8,117.1,117.1,121.8,126,126,130.3,134.6,138.8,138.8,143.5,147.8,147.8,152.1,156.3,156.3,161,165.3,169.6,169.6,173.8,178.1,178.1,182.8,187.1,187.1,191.3,195.6,199.9,199.9,204.5,208.8,208.8,213.1,217.3,217.3,222,226.3,230.6,230.6,234.8,239.1,239.1,243.8,248.1,248.1,252.3,256.6,261.3,261.3,265.6,269.8,269.8,274.1,278.4,278.4,283.1,287.3,291.6,291.6,295.9,299.6,299.6,299.9,300.2,300.2,300.4,290.2,285.5,285.5,281.3,277,277,272.7,268.5,268.5,263.8,259.5,255.2,255.2,251,246.3,246.3,242,237.7,237.7,233.5,229.2,224.5,224.5,220.2,216,216,211.7,207.4,207.4,202.7,198.5,194.2,194.2,189.9,185.2,185.2,181,176.7,176.7,172.4,168.2,163.5,163.5,159.2,155,155,150.6,145.9,145.9,141.6,137.3,133.1,133.1,128.8,124.1,124.1,119.8,115.6,115.6,111.3,107,102.3,102.3,98.1,93.8,93.8,89.5,84.8,84.8,80.6,76.3,72,72,67.8,63.1,63.1,58.8,54.6,54.6,50.3,46,41.3,41.3,37.1,32.8,32.8,28.5,23.8,23.8,19.6,15.3,11,11,6.8,2.6]"
CONTEXT:  SQL statement "INSERT INTO stage.tbl_pozo_scada_dq (
                produccion_id, timestamp_lectura, variable_id, regla_id,
                valor_observado, valor_esperado_min, valor_esperado_max, resultado_dq
            )
             SELECT 
                produccion_id, 
                timestamp_lectura, 
                '115'::INT, 
                '27'::INT, 
                surface_rod_position::DECIMAL, 
                '0.0001'::DECIMAL, 
                NULL::DECIMAL, 
                CASE 
                    WHEN surface_rod_position::DECIMAL < '0.0001'::DECIMAL OR surface_rod_position::DECIMAL > NULL::DECIMAL THEN 'FAIL' 
                    ELSE 'PASS' 
                END
             FROM stage.tbl_pozo_produccion
             WHERE timestamp_lectura::DATE BETWEEN '2020-01-01'::DATE AND '2030-12-31'::DATE
               AND (surface_rod_position::DECIMAL IS NOT NULL) ON CONFLICT DO NOTHING"
PL/pgSQL function stage.sp_execute_dq_validation(date,date,integer) line 64 at EXECUTE


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\leopo\.pyenv\pyenv-win\versions\3.11.8\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type numeric: "[1.9,4.6,4.6,8.4,12.6,16.8,16.8,21.5,25.8,25.8,30,34.3,34.3,38.6,43.3,47.5,47.5,51.8,56.1,56.1,60.8,65,65,69.3,73.6,77.8,77.8,82.5,86.8,86.8,91,95.3,95.3,99.6,104.3,108.5,108.5,112.8,117.1,117.1,121.8,126,126,130.3,134.6,138.8,138.8,143.5,147.8,147.8,152.1,156.3,156.3,161,165.3,169.6,169.6,173.8,178.1,178.1,182.8,187.1,187.1,191.3,195.6,199.9,199.9,204.5,208.8,208.8,213.1,217.3,217.3,222,226.3,230.6,230.6,234.8,239.1,239.1,243.8,248.1,248.1,252.3,256.6,261.3,261.3,265.6,269.8,269.8,274.1,278.4,278.4,283.1,287.3,291.6,291.6,295.9,299.6,299.6,299.9,300.2,300.2,300.4,290.2,285.5,285.5,281.3,277,277,272.7,268.5,268.5,263.8,259.5,255.2,255.2,251,246.3,246.3,242,237.7,237.7,233.5,229.2,224.5,224.5,220.2,216,216,211.7,207.4,207.4,202.7,198.5,194.2,194.2,189.9,185.2,185.2,181,176.7,176.7,172.4,168.2,163.5,163.5,159.2,155,155,150.6,145.9,145.9,141.6,137.3,133.1,133.1,128.8,124.1,124.1,119.8,115.6,115.6,111.3,107,102.3,102.3,98.1,93.8,93.8,89.5,84.8,84.8,80.6,76.3,72,72,67.8,63.1,63.1,58.8,54.6,54.6,50.3,46,41.3,41.3,37.1,32.8,32.8,28.5,23.8,23.8,19.6,15.3,11,11,6.8,2.6]"
CONTEXT:  SQL statement "INSERT INTO stage.tbl_pozo_scada_dq (
                produccion_id, timestamp_lectura, variable_id, regla_id,
                valor_observado, valor_esperado_min, valor_esperado_max, resultado_dq
            )
             SELECT 
                produccion_id, 
                timestamp_lectura, 
                '115'::INT, 
                '27'::INT, 
                surface_rod_position::DECIMAL, 
                '0.0001'::DECIMAL, 
                NULL::DECIMAL, 
                CASE 
                    WHEN surface_rod_position::DECIMAL < '0.0001'::DECIMAL OR surface_rod_position::DECIMAL > NULL::DECIMAL THEN 'FAIL' 
                    ELSE 'PASS' 
                END
             FROM stage.tbl_pozo_produccion
             WHERE timestamp_lectura::DATE BETWEEN '2020-01-01'::DATE AND '2030-12-31'::DATE
               AND (surface_rod_position::DECIMAL IS NOT NULL) ON CONFLICT DO NOTHING"
PL/pgSQL function stage.sp_execute_dq_validation(date,date,integer) line 64 at EXECUTE

[SQL: CALL stage.sp_execute_dq_validation('2020-01-01'::DATE, '2030-12-31'::DATE, NULL::INT);]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
